<!-- ### edit 模板 ### -->
<#include "/common/_layout.html" />
<@layout>
<script type="text/javascript">
$(document).ready(function(){
	console.log("############");
	//获取初始值
	var sdoc = $("#doc")[0].value,
		  spic = $("#pic")[0].value;
	//console.log("sdoc value: " + sdoc);
	//console.log("typeof(sdoc): " + typeof(sdoc));
	//console.log("sdoc.length: " + sdoc.length);
	//console.log("\n");
	
  $("#sub").click(function(){
	  //获取新文件的文件名
	  	var edoc, epic;
		var docFileValue =  $("#docfile")[0].value,
			  picFileValue =  $("#picfile")[0].value;
		//console.log("docFileValue value: " + docFileValue);
		//console.log("typeof(docFileValue): " + typeof(docFileValue));
		//console.log("docFileValue.length: " + docFileValue.length);
		//console.log("\n");
		
		if(docFileValue.length != 0){
			var valueDoc = new Array(),
			valueDoc = docFileValue.split("\\");
			var fdoc = valueDoc[valueDoc.length-1];
			//console.log("fdoc value: " + fdoc);
			//console.log("typeof(fdoc): " + typeof(fdoc));
			//console.log("fdoc.length: " + fdoc.length);
			//console.log("\n");
			
			edoc = fdoc;
		}else{
			edoc = sdoc;
		}
		
		if(picFileValue.length != 0){
			var valuePic = new Array(),
			valuePic = picFileValue.split("\\");
			var fpic = valuePic[valuePic.length-1];
			//console.log("fpic value: " + fpic);
			//console.log("typeof(fpic): " + typeof(fpic));
			//console.log("fpic.length: " + fpic.length);
			//console.log("\n");
			
			epic = fpic;
		}else{
			epic = spic;
		}
		
		
		$("#doc")[0].value = edoc;
		$("#pic")[0].value = epic;
		//更新文件名
		//console.log("doc.value: " + $("#doc")[0].value);
		//console.log("pic.value: " + $("#pic")[0].value);
		//console.log("&&&&&&&&&&&&&&&&&&&&");
		});
});
</script>

<!-- 后期优化使用，代码复用 -->
<!--
<h1>资源管理 ---&gt; 修改
</h1>
<div class="form_box" style="text-align:center;">
	<form action="/src/update" method="post">
		<#include "_form.html" />
	</form>
</div>
-->

<h1>资源管理 ---&gt; 修改
</h1>
<div class="form_box">
	<form action="/src/update" method="post" enctype="multipart/form-data">
		<fieldset class="solid">
			<legend>资源</legend>
			<input type="hidden" name="source.id" value="${(source.id)!}" />
			<input type="hidden" name="source.author" value="${(source.author)!}" />
			<input type="hidden" name="source.author_id" value="${(source.author_id)!}" />
			<input id="doc" type="hidden" name="source.docpath" value="${(source.docpath)!}" />
			<input id="pic" type="hidden" name="source.picpath" value="${(source.picpath)!}" />
			<div>
				<label>标题</label>
				<input type="text" name="source.title" value="${(source.title)!}" />${titleMsg!}
				&nbsp;&nbsp;
				<label>类别</label>
				<input type="text" name="source.type" value="${(source.type)!}" />${typeMsg!}
			</div>
			<div>
				<label>内容</label>
				<textarea name="source.content" cols="80" rows="10">${(source.content)!}</textarea>${contentMsg!}
			</div>
			<br>
			<br>
			<div>
				<input type="file" id="docfile" name="source.docpath"></input>
				<input type="file" id="picfile" name="source.picpath"></input>
				<label>&nbsp;</label>
				<input id="sub" value="提交" type="submit">
			</div>
		</fieldset>
	</form>
</div>
</@layout>


